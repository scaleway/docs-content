---
meta:
  title: How to manage Kubeconfig files with IAM
  description: This page explains how to manage Scaleway Kubeconfig files with IAM
content:
  h1: How to manage Kubeconfig files with IAM
  paragraph: This page explains how to manage Scaleway Kubeconfig files with IAM
tags: kubernetes kapsule-cluser
dates:
  validation: 2024-11-05
  posted: 2024-11-05
categories:
  - kubernetes
---

A Kubeconfig file serves as a repository for essential credentials required to access a Kubernetes cluster and manage deployments.  
This file contains critical information, including cluster details, authentication data, and context information, allowing users to oversee and configure their Kubernetes clusters.

Scaleway's Identity and Access Management (IAM) is now being used to generate Kubeconfig files. This integration offers several advantages:

- **Improved user administration:**
   - When removing a cluster user, there is no longer a need to reset the admin token, mitigating security risks.
- **Increased cluster security:**
   - Each user has unique credentials, enhancing security.
   - Audit logs facilitate the identification of specific Kubernetes users.
- **Enhanced application security:**
   - Applications within the cluster are authenticated using specific tokens.
   - This authentication method is particularly useful when a pod needs to interact with the Kubernetes API, as it can authenticate using its associated [Service Account](https://kubernetes.io/docs/concepts/security/service-accounts/).

[Identity and Access Management (IAM)](/identity-and-access-management/iam/concepts/#iam) provides control over resource access. IAM policies enable the configuration of permissions for Kubernetes Kapsule clusters at the Project level.

An [IAM policy](/identity-and-access-management/iam/concepts/#policy) defines the permissions for users, groups, and applications within an Organization. It consists of a [principal](/identity-and-access-management/iam/concepts/#principal) (the user, group, or application to which it applies) and IAM rules that specify permission sets and their scope.

The [combination of IAM and Kubernetes RBAC (Role-based Acccess Control)](/containers/kubernetes/reference-content/set-iam-permissions-and-implement-rbac/) allows you to define fine-grained access levels for cluster users.

<Message type="important">
    Entering a deprecation cycle, the former authentication system (using static admin tokens) remains active until the second half of 2024: all your legacy Kubeconfig files keep access to their clusters for the time being. For security purposes, you can still use the ["reset admin token" feature](/containers/kubernetes/how-to/revoke-kubeconfig/), either through our Kubernetes API or Scalewayâ€™s CLI.
    We recommend that you download and use new unique, identifiable Kubeconfig files with IAM tokens inside.
</Message>

<Macro id="iam-requirements" />

<Message type="requirement">
  - A Scaleway account logged into the [console](https://console.scaleway.com)
  - [Created](/containers/kubernetes/how-to/create-cluster) a Kubernetes Kapsule cluster
</Message>

## Setting up access

1. [Create a group](/identity-and-access-management/iam/how-to/create-group/) named `k8s-group` that contains the user and the application, so they are the only ones to have access to your cluster.
2. [Create an IAM policy](/identity-and-access-management/iam/how-to/create-policy/) named `k8s-policy` in the Scaleway console, with the previously created group as a [principal](/identity-and-access-management/iam/concepts/#principal). Apply the corresponding IAM policy to the group. For example, `KubernetesFullAccess`.
<Message type="tip">
  Refer to [Setting IAM permissions and implement RBAC on a cluster](/containers/kubernetes/reference-content/set-iam-permissions-and-implement-rbac/) for a detailed overview about the available IAM permissions and how to fine-tune them using Kubernetes RBAC.
</Message>

## Downloading the Kubeconfig file

1. Click **Kubernetes** in the **Containers** section of the [Scaleway console](https://console.scaleway.com) side menu. The Kubernetes Kapsule overview displays.
2. Click the name of the cluster you want to access. The cluster overview page displays. Click on the name of the cluster you want to manage.
3. Scroll down to the **Download kubeconfig with IAM** section of the page.
4. Click **Download kubeconfig**
5. Select the API key bearer, enter a description and set the expiration date for the kubeconfig file, then click **Generate kubeconfig**.
6. Download the kubeconfig file and export the path to start using it with `kubectl`.

You can now manage your cluster using `kubectl`. For more information about this tool, refer to the [official kubectl documentation](https://kubernetes.io/docs/reference/kubectl/).
