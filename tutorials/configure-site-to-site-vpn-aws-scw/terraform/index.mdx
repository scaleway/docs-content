---
title: Establishing a Site-to-Site VPN between Scaleway and AWS with Terraform
description: Learn how to configure a dynamic Site-to-Site VPN between Scaleway and AWS using Scaleway Managed VPN Gateway and BGP
products:
  - vpc
  - s2s-vpn
  - secret-manager
tags: vpn ipsec bgp aws hybrid-cloud
dates:
  validation: 2026-02-16
  posted: 2026-02-16
  validation_frequency: 12
difficulty: advanced
usecase:
  - hybrid-connectivity
ecosystem:
  - third-party
---
import Requirements from '@macros/iam/requirements.mdx'

This tutorial explains how to establish a dynamic Site-to-Site (S2S) VPN between Scaleway and AWS using the Scaleway Managed VPN Gateway.

The configuration uses:

- IPsec over IKEv2
- BGP for dynamic routing
- Route propagation between both environments

---
<Requirements />
  - A Scaleway account logged into the [console](https://console.scaleway.com)
  - An AWS account with appropriate permissions
  - [Terraform installed](https://developer.hashicorp.com/terraform/downloads) on your local machine
  - [Scaleway CLI](https://github.com/scaleway/scaleway-cli) configured (optional, for verification)


**See the full code example:** [github.com/ysow/site-to-site-vpn-aws-scw](https://github.com/ysow/site-to-site-vpn-aws-scw)


## Step 1 : Scaleway Network Initialization
First, establish the networking foundation on Scaleway to generate the public IP address required by AWS.

**Terraform Resources:**
* `scaleway_vpc` & `scaleway_vpc_private_network`
* `scaleway_s2s_vpn_gateway` (Type: `VGW-S`)

<Message type="tip">
  **Key Configuration:** Ensure you output the Public IP of the gateway, as AWS will need this to create the "Customer Gateway" object.
</Message>

```hcl
# Output to use in AWS configuration
output "vpn_gateway_public_ip" {
  value = data.scaleway_ipam_ip.vpn_gw_public_ip.address
}

```


## Step 2 AWS Network & Customer Gateway
Configure the AWS side. You must use the Public IP obtained from Step 1.

**Terraform Resources:**

* `aws_vpc`, `aws_subnet`
* `aws_vpn_gateway` (The AWS side of the VPN)
* `aws_customer_gateway` (The representation of the Scaleway side)

**Crucial Settings:**

* **BGP ASN for Scaleway:** `12876` (Set this in the `aws_customer_gateway` resource).
* **BGP ASN for AWS:** `65000` (Default for AWS VPG).


## Step 3 Configuring the VPN Tunnel (IPSec & BGP)
This is the most critical step. Mismatched settings will result in a `DOWN` status.

**1. Encryption Alignment (IKEv2)**
Both `aws_vpn_connection` and `scaleway_s2s_vpn_connection` must match exactly:

* **Encryption:** `AES-256`
* **Integrity:** `SHA2-256`
* **DH Group:** `14` (MODP2048)

**2. BGP Peering (Inside IPs)**
You must define a `/30` Link-Local subnet (e.g., `169.254.131.116/30`).

* **AWS Side:** Usually takes the first available IP (e.g., `.117`).
* **Scaleway Side:** Must take the second available IP (e.g., `.118`).

<Message type="warning">
If you swap these IPs, BGP will not establish.
</Message>

## Step 4 Retrieve PSK and Redeploy AWS Gateway 
Scaleway automatically generates a secure Pre-Shared Key (PSK) when the VPN connection resource is created. You must extract this key to finalize the AWS configuration.

1. **Retrieve the PSK** using the Terraform output:
```bash
terraform output -json scw_vpn_psk

```

Copy the value of the key (without quotes).
2. **Update your variables** (e.g., in `terraform.tfvars`) with the retrieved key:
```hcl
scw_vpn_psk = "<PASTE_YOUR_KEY_HERE>"

```


3. Run `terraform apply`.
This applies the configuration to the `aws_vpn_connection` resource. Terraform will now update the AWS tunnel with the correct authentication key.
```bash
terraform apply

```


## Step 5 Verify the Connection
Once the second apply is complete, verify the health of the connection.

**Using Scaleway CLI:**

1. Get the Connection ID:
```bash
scw s2s-vpn connection list

```


2. Check the status:
```bash
scw s2s-vpn connection get <CONNECTION_ID>

```


You should see:
* `TunnelStatus`: **up**
* `BgpStatusIPv4`: **up**



**Using AWS Console:**
Navigate to **VPC** > **Site-to-Site VPN Connections**. The Tunnel State should be `UP` and the Details tab should show `1 BGP ROUTE`.


## Result

You have successfully established a dynamic Site-to-Site VPN between Scaleway and AWS using:

- Managed VPN Gateway
- BGP route exchange
- Secure IPsec encryption
- Dynamic route propagation between VPCs