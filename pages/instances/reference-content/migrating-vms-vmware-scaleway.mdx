---
meta:
  title: Migrating VMware virtual machines to Scaleway Instances
  description:  Find out how to migrate virtual VMware machines to Scaleway Instances.
  h1: Migrating VMware virtual machines to Scaleway Instances
  paragraph:  Find out how to migrate virtual VMware machines to Scaleway Instances.
dates:
  validation: 2025-03-03
  posted: 2023-02-22
categories:
  - compute
tags: instance type production production-optimized range POP2 ENT1
---

## Validating the inventory of machines to migrate

Identify the virtual machines (VMs) to migrate on your VMware plattform:

- Disk configuration (number, size, type)
- Network configuration (number of NICs, type)
- Boot type (BIOS or UEFI)


## Preparing a Scaleway Instance to manage the migration

1. [Create a new instance](/instances/how-to/create-an-instance/) and log into it [using SSH](/instances/how-to/connect-to-instance/).
2. Install the following CLI tools, required for the migration of your virtual machine:
   - `qemu-img` — for converting VMDK to QCOW2
      ```sh
      apt install qemu-utils
      ```
   - `scw` — for Scaleway operations
      ```sh
      curl -s https://raw.githubusercontent.com/scaleway/scaleway-cli/master/scripts/get.sh | sh
      ```
   - `aws` — for uploading to S3
      ```
      curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
      unzip awscliv2.zip
      sudo ./aws/install
      ```
   - `govmomi` — for interacting with vCenter
     ```
     curl -L -o - "https://github.com/vmware/govmomi/releases/latest/download/govc_$(uname -s)_$(uname -m).tar.gz" | tar -C /usr/local/bin -xvzf - govc
     ```

3. Configure credentials for the tools:
   - For Scaleway: `scw init`
   - For AWS/S3: Refer to [Using Object Storage with the AWS-CLI](https://www.scaleway.com/en/docs/object-storage/api-cli/object-storage-aws-cli/)
   - For vCenter: credentials and VPN (if needed)

## Downloading VMDK files using govmomi

Download the VMDK file from vCenter:

```bash
govc export.ovf -vm <vm_name>
```

<Message type="note">
  Adjust this based on your `govmomi`/`govc` setup and environment.
</Message>

## Converting the VMDK file to QCOW2**

Convert the downloaded VMDK file to QCOW2 using `qemu-img`:

```bash
qemu-img convert -O qcow2 <vm_name>.vmdk <vm_name>.qcow2
```

### (Optional): Mounting the QCOW2 file and system configuration

1. Mount the QCOW2 image on your Instance:
  ```bash
  sudo modprobe nbd
  sudo qemu-nbd -c /dev/nbd0 <vm_name>.qcow2
  ```
  Make any changes (e.g., install cloud-init, remove VMware tools).

2. Unmount the file:

```bash
sudo qemu-nbd -d /dev/nbd0
```

## Uploading the QCOW2 image to Scaleway Object Storage

Upload the converted disk:

```bash
aws s3 cp <vm_name>.qcow2 s3://<bucket_name>/
```

## Importing the QCOW2 image from Object Storage into Scaleway as a volume

Import into a new volume:

```bash
scw instance volume import qcow2-from-s3 \
  s3-url=s3://<bucket_name>/<vm_name>.qcow2 \
  name=<volume_name> \
  project-id=<project_id> \
  zone=<zone>
```

> You can retrieve project ID and zone using `scw project list` and `scw zone list`.

---

### **Step 8: Create an image from the imported volume**

```bash
scw instance image create-from-volume \
  volume-id=<volume_id> \
  name=<image_name> \
  zone=<zone>
```

---

### **Step 9: Create Private Networks if needed**

```bash
scw vpc private-network create \
  name=<pn_name> \
  ipam-configs.0.cidr=<subnet_cidr>
```

---

### **Step 10: Boot an instance with the image and attach PN**

Create a new server:

```bash
scw instance server create \
  name=<instance_name> \
  image-id=<image_id> \
  commercial-type=<type> \
  zone=<zone> \
  private-nics.0.private-network-id=<pn_id>
```

Start the server:

```bash
scw instance server start server-id=<server_id> zone=<zone>
```

---

## ✅ Final Notes

- Run `scw --help` or `scw instance server create --help` for more guidance.
- Double-check your Scaleway **region/zone compatibility** (e.g., `fr-par-1`, `nl-ams-1`, etc.).
- Ensure the image is cloud-ready: ideally includes `cloud-init`.