---
meta:
  title: How to manage a Kubernetes Kosmos cluster
  description: This page explains how to manage a Kubernetes Kosmos cluster
content:
  h1: How to manage a Kubernetes Kosmos cluster
  paragraph: This page explains how to manage a Kubernetes Kosmos cluster
tags: kubernetes kosmos-cluster kosmos
dates:
  validation: 2023-05-25
  posted: 2021-05-31
categories:
  - kubernetes
---

You can add nodes and pools to your Kosmos cluster from the [Scaleway Console](https://console.scaleway.com) or by using the [API](https://www.scaleway.com/en/developers/). Here, we show you how to edit from the console.

<Macro id="iam-requirements" />

<Message type="note">
  This document concerns the management of a Kosmos cluster. For a Kapsule cluster, refer to the [corresponding documentation for Kapsule](/containers/kubernetes/how-to/edit-cluster)
</Message>

<Message type="important">
  Be aware that nodes from multi-cloud pools cannot benefit from the auto-healing and auto-scaling features of Scaleway Kapsule pool. Since Scaleway does not have access to your other providers' accounts, it is not possible to carry out actions such as automatic deletion, creation,and reboot of external nodes.
</Message>

<Message type="requirement">
  - You have an account and are logged into the [Scaleway console](https://console.scaleway.com)
  - You have [created](/containers/kubernetes/how-to/create-cluster) a Kubernetes Kosmos cluster
  - You have external machines (`arm64` or `amd64`) running **Ubuntu** or **Debian** that you want to add to your cluster
</Message>

## How to add a multi-cloud pool to your Kosmos cluster

A multi-cloud pool allows you to attach external Instances and servers to your cluster. Instances added to the same pool do not need to share the same configuration, nor do they have to be managed by the same Cloud provider. 

1. Click **Kubernetes** in the Containers section of the side menu. The Kubernetes creation page displays.
2. Click the cluster you want to add a pool to.
3. Click the **Pools** tab.
4. Click the **+ Add pool** button. The pool creation wizard displays.
5. Complete the following steps of the wizard:
    * Choose a **pool type**. This can be a Scaleway Kubernetes Kapsule Pool or a Kubernetes Multi-Cloud Pool. This document concerns the addition of a Multi-Cloud Pool.
        <Lightbox src="scaleway-choose-pool-type.webp" alt="" />
    * A **name** for the pool and optionally a description and tags.
6. Click **Add pool** to finish.

## How to add external nodes to your multi cloud pool

In order to add external nodes to your Multi Cloud cluster, you must first [create a Multi Cloud pool](#how-to-add-a-multi-cloud-pool-to-your-kosmos-cluster). For security reasons, it is recommended to configure an API key with the `KubernetesExternalNodeRegister` IAM permission set.

1. Click **Identity and Access Management (IAM)** from the top-right of your [**Organization Dashboard**](https://console.scaleway.com/organization) in the Scaleway console. The [Identity and Access Management dashboard](https://console.scaleway.com/iam/) displays.
2. [Create an IAM Policy](/identity-and-access-management/iam/how-to/create-policy/) with the `KubernetesExternalNodeRegister` PermissionSet only.
    <Lightbox src="scaleway-kubernetes-kubernetesexternalnoderegister.webp" alt="" />
3. [Create an IAM Application](/identity-and-access-management/iam/how-to/create-application/) linked with the policy created in the previous step.
    <Lightbox src="scaleway-kosmos-add-application.webp" alt="" />
4. [Create a new API key](/identity-and-access-management/iam/how-to/create-api-keys/) linked to the IAM application created in the previous step.
    <Lightbox src="scaleway-koslos-generate-api-key.webp" alt="" />
    <Message type="tip">
      Identity and Access Management (IAM) allows you to share access to the management of your Scaleway resources and Organization settings, in a controlled and secure manner. For more information, refer to our [dedicated IAM documentation](/identity-and-access-management/iam/quickstart/).
    </Message>
5. Click **Kubernetes** in the Compute section of the side menu. The Kubernetes creation page displays.
6. Click the cluster you want to add external nodes to.
7. Click **Nodes** on the tab.
8. Click **+ Add an external node**. The instructions for adding an external node display.

## How to configure external nodes to join the cluster

1. Get your server's public IP and SSH to the server:

    ```bash
    ssh <user>@<server_ip>
    ```

2. Download the `node-agent` program:

    ```bash
    wget https://scwcontainermulticloud.s3.fr-par.scw.cloud/node-agent_linux_amd64 && chmod +x node-agent_linux_amd64
    ```

3. Export the required environment variables:

    ```bash
    export POOL_ID=<pool_id>  POOL_REGION=<cluster_region>  SCW_SECRET_KEY=<secret_key>
    ```

4. Execute the program to attach the node to the multi cloud pool:

    ```bash
    sudo ./node-agent_linux_amd64 -loglevel 0 -no-controller
    ```
    <Message type="note">
      There is also an ARM binary (named `node-agent_linux_arm64`) for ARM-based nodes.
    </Message>

## How to detach nodes from your multi cloud pool

1. Click **Kubernetes** in the Compute section of the side menu. The Kubernetes creation page displays.
2. Click the cluster in question.
3. Click the **Nodes** tab.
4. Click the unlink icon next to the node you want to detach. A pop-up asks you to confirm the action.
5. Click **Detach node**.
    <Message type="note">
      This action will remove your node from the cluster. Your external node will not be deleted from your other cloud provider account(s).
    </Message>


<Navigation title="See Also">
  <PreviousButton to="/containers/kubernetes/how-to/create-kosmos-cluster/">How to create a Kosmos cluster</PreviousButton>
  <NextButton to="/containers/kubernetes/how-to/connect-cluster-kubectl/">How to connect to a cluster with kubectl</NextButton>
</Navigation>
