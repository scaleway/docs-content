---
meta:
 title: Setting up and using the pgcron extension
 description: This page explains how to set up and use the pgcron extension.
content:
 h1: Setting up and using the pgcron extension
 paragraph: This page explains how to set up and use the pgcron extension.
tags: managed-database postgresql pgcron pg-extensions
dates:
 validation: 2025-02-17
 posted: 2025-02-17
categories:
 - managed-databases
 - postgresql-and-mysql
---

The pg_cron extension for PostgreSQL is used to execute periodic tasks. You can schedule SQL tasks, such as queries and data imports, to run at regular intervals. This allows you to automate the tasks to be run regularly, on a daily, weekly or monthly basis, for example.

The `pgcron` extension is available with Scaleway Managed Databases for PostgreSQL. The extension is natively loaded in the `shared_preload_libraries` of the Database Instances by default.

<Macro id="requirements" />

- A Scaleway account logged into the [console](https://console.scaleway.com)
- [Owner](/iam/concepts/#owner) status or [IAM permissions](/iam/concepts/#permission) allowing you to perform actions in the intended Organization
- A [Database Instance](/managed-databases-for-postgresql-and-mysql/how-to/create-a-database/) running a PostgreSQL engine

## Installing pgcron


1. Run the following command to install the extension:

```sql
rdb=> CREATE EXTENSION pg_cron;
CREATE EXTENSION
```

## Configuring pg_cron

<Message type="note">
  To fully use the extension, you must grant read/write rights to the user who will be running the `pg_cron` functions to manage jobs on the database. Refer to the [How to add users to a PostgreSQL or MySQL Database Instance](/managed-databases-for-postgresql-and-mysql/how-to/add-users) documentation for more information.
</Message>

## Scheduling jobs

To schedule jobs, you can run the following commands:

```sql
-- Delete old data on Saturday at 3:30am (GMT)
SELECT cron.schedule('30 3 * * 6', $$DELETE FROM events WHERE event_time < now() - interval '1 week'$$);
```

```sql
-- Change to vacuum at 3:00am (GMT)
SELECT cron.schedule('nightly-vacuum', '0 10 * * *', 'VACUUM');
```

**Listing Jobs**

To list all scheduled jobs, you can run the following command:

```sql
SELECT * FROM cron.job;
-[ RECORD 1 ]-------------------------------------------------------------
jobid | 1
schedule | 30 3 * * 6
command | DELETE FROM events WHERE event_time < now() - interval '1 week'
nodename | /var/run/postgresql
nodeport | 5432
database | rdb
username | myuser
active | t
jobname |
-[ RECORD 2 ]-------------------------------------------------------------
jobid | 2
schedule | 0 10 * * *
command | VACUUM
nodename | /var/run/postgresql
nodeport | 5432
database | rdb
username | myuser
active | t
jobname | nightly-vacuum
```

**Unscheduling Jobs**

To unschedule a job, you can run the following command:

```sql
SELECT cron.unschedule(1);
unschedule
------------
t
(1 row)
```

or

```sql
SELECT cron.unschedule('nightly-vacuum');
unschedule
------------
t
(1 row)
```

**Scheduling Jobs in Other Databases**

To schedule a job in another database, you can use the `schedule_in_database` function:

```sql
SELECT cron.schedule_in_database('job-in-another-db', '0 12 * * *', 'INSERT INTO public.another_db_table values (now())', 'mydb');
schedule
----------
3
```

Note that cron.schedule_in_database runs jobs as the user who created them, so you'll need to connect as that user to execute the job.
Additionally, this function doesn't allow specifying a different user, as it would require superuser privileges.

**Editing Jobs**

To edit a job, you can use the `alter_job` function:

```sql
SELECT cron.alter_job(job_id:=3,database:='anotherdb');
-[ RECORD 1 ]
alter_job |
```

**Cron Syntax**

The schedule uses the standard cron syntax:

```
┌───────────── min (0 - 59)
│ ┌────────────── hour (0 - 23)
│ │ ┌─────────────── day of month (1 - 31) or last day of the month ($)
│ │ │ ┌──────────────── month (1 - 12)
│ │ │ │ ┌───────────────── day of week (0 - 6) (0 to 6 are Sunday to
│ │ │ │ │ Saturday, or use names; 7 is also Sunday)
│ │ │ │ │
│ │ │ │ │
* * * * *
```

**Time Zone**

The time zone of the pg_cron extension can be changed in the advanced settings of the instance: `cron.timezone`. By default, the time zone is set to GMT.