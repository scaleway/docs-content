---
meta:
  title: Getting started with Socket.io
  description: This tutorial shows how to install Socket.io on a Scaleway Instance
content:
  h1: Getting started with Socket.io
  paragraph: This tutorial shows how to install Socket.io on a Scaleway Instance
tags: Socket.IO socket server 
steps:
  - step: Installing Express.js and Socket.io
    type: HowToStep
    url: https://www.scaleway.com/en/docs/how-to-install-and-configure-socket-io/#-Installing-Expressjs-and-Socketio
  - step: Creating an Express Server
    type: HowToStep
    url: https://www.scaleway.com/en/docs/how-to-install-and-configure-socket-io/#-Creating-an-Express-Server
  - step: Connecting a Client to the Server using Socket.io
    type: HowToStep
    url: https://www.scaleway.com/en/docs/how-to-install-and-configure-socket-io/#-Connecting-a-Client-to-the-Server-using-Socketio
  - step: Setting up the Socket Server
    type: HowToStep
    url: https://www.scaleway.com/en/docs/how-to-install-and-configure-socket-io/#-Setting-up-the-Socket-Server
  - step: Excluding the Socket Server
    type: HowToStep
    url: https://www.scaleway.com/en/docs/how-to-install-and-configure-socket-io/#-Excluding-the-Socket-Server
categories:
  - compute
dates:
  validation: 2022-02-07
  posted: 2018-07-05
---

Socket.io enables real-time event-based communication between one or more clients and a server. It works on every platform, browser or device and is fast and reliable. Socket.io has two parts: a client-side library that runs in the browser, and a server-side library for Node.js. Both components have an identical API.

In this tutorial, you will learn how to use Socket.io with Express and create a simple chat server and show the basics of how a client and server work together.

<Message type="requirement">

- You have an account and are logged into the [Scaleway Console](https://console.scaleway.com)
- You have a [Scaleway Instance](/compute/instances/how-to/create-an-instance/) running Ubuntu Xenial
- You have [configured your SSH Key](/console/my-project/how-to/create-ssh-key/)
- You have root access to all of the Instances you want to manage
- You have [Node.js](https://nodejs.org/en/) and [NPM (Node Package Manager)](https://www.npmjs.com/) installed on your Instance. 

</Message>

### Installing Express.js and Socket.io

Express is a minimal and flexible Node.js web application framework.

1. Create a folder. In this tutorial we will call it `myapp`.

  ```
  mkdir myapp
  cd myapp
  ```

2. Use npm init to create a package.json.

  ```
  npm init
  ```

  The npm init command will create an empty project with a package.json file. You can answer all the questions or press enter through all of them if you do not want to.

3. Install Express and Socket.io and save them to our package.json file for later.

  ```
  npm install socket.io express --save
  ```

4. Install jquery.

  ```
  npm install jquery --save
  ```

### Creating an Express server

1. Create a new file in the socket-app folder.

  ```
  mkdir app.js
  ```

2. In the new file called `app.js`, paste the following content:

  ```js
  // app.js
  var express = require('express');
  var app = express();
  var server = require('http').createServer(app);
  var io = require('socket.io')(server);

  app.use(express.static(__dirname + '/node_modules'));
  app.get('/', function(req, res,next) {
      res.sendFile(__dirname + '/index.html');
  });

  server.listen(4200);
  ```

  We use this file to require Express, to create a new server, and require Socket.io as well.

  We also use it to set the static folder to `/node_modules` since we use npm to server up jQuery and we want to be able to reference it in our html.

  App.get routes HTTP requests to the specified path with a specific call-back function. The `res` object represents the HTTP response that an Express app sends when it gets a request. The `sendFile` sends the file to the specified path. The `server.listen` will open a port and listen for requests coming in.

3. Create an index.html file to display a `Hello World` message.

  ```html
  <!doctype html>
  <html lang="en">
      <head>

      </head>
      <body>
          <h1>Hello World!</h1>
          <div id="future"></div>
          <form id="form" id="chat_form">
              <input id="chat_input" type="text">
              <input type="submit" value="Send">
          </form>
          <script src="/jquery/dist/jquery.js"></script>
          <script src="/socket.io/socket.io.js"></script>
      </body>
  </html>
  ```

  The src scripts point to files in our `node_modules` folder.

4. Launch the server.

  ```
  node app.js
  ```

5. Open up a browser at `http://Server_IP:4200`. It should display the following:

<Lightbox src="scaleway-Hello_world.png" alt="Hello World" />

### Connecting a client to a server using Socket.io

In the next steps we connect the client to the server with Socket.io and have it respond in the console.

1. In the `app.js` file, edit the `index.html` to add this script to the bottom of the file

  ```html
  <!--Index.html-->
  ...
  <script>
  var socket = io.connect('http://10.1.220.19:4200');
  socket.on('connect', function(data) {
      socket.emit('join', 'Hello World from client');
  });
  </script>
  ```

  The `socket.on('connect')` is an event fired upon a successful connection from the web browser. We then have a function callback that will send the hello world message to the server.

2. Edit the `app.js` file to add just before the `server.listen` the following configuration. We have included `server.listen` in the example below to remind you to close the parentheses.

  ```js
  // app.js

  io.on('connection', function(client) {
      console.log('Client connected...');
      client.on('join', function(data) {
        console.log(data);
      });
  });

  server.listen(4200);
  ```

  The `io.on` is listening for connections. When it receives one it will report to the console `client connected...`. The `'client.on('join')` will wait for a message from the client to `join`. It will then log in to the console.

3. Launch the node again.

  ```
  node app.js
  ```

<Lightbox src="scaleway-ClientConnected.png" alt="" />

### Setting up the Socket server

<Message type="important">

The following section can only work if your server is set up locally.

</Message>

We will configure the server so it replies to the client with a message.

1. Add the `emit` line after console.log.

  ```js
  // app.js
  io.on('connection', function(client) {
      console.log('Client connected...');
      client.on('join', function(data) {
        console.log(data);
        client.emit('messages', 'Hello from server');
      });
  });

  server.listen(4200);
  ```

  The client.emit will send a message back to the client that just connected with a message using 'messages'.

2. Add a new `socket.on` message event in the `index.html`.

  ```js
  // index.html
          socket.on('messages', function(data) {
                  alert(data);
          });
  ```

  Now when a client connects, it will send a message to the server and it will trigger a pop-up.

### Excluding the Socket server

In the previous examples we saw that we can send a message to the server and that we can also send a message back to the client. Now, if we need to send a message to all the clients excluding the socket that started it, it is also possible.

1. Update the `index.html`

```html
<script>
var socket = io.connect('http://51.15.244.129:4200');
socket.on('connect', function(data) {
socket.emit('join', 'Hello World from client');
});
socket.on('broad', function(data) {
    $('#future').append(data+ "<br/>");
});

$('form').submit(function(e){
e.preventDefault();
var message = $('#chat_input').val();
socket.emit('messages', message);
});

</script>
```

  We added in a new `JQuery .submit` event handler which prevents the form from submitting and instead send a message to the server with the values of the input field in messages.

  Also, we added a new socket event listener for 'broad' which updates our div with the message that was returned.

2. Update the `app.js`

  ```js
  // app.js
  ...
  io.on('connection', function(client) {
      console.log('Client connected...');
      client.on('join', function(data) {
          console.log(data);
          client.on('messages', function(data) {
              client.emit('broad', data);
              client.broadcast.emit('broad',data);
          });
      });
  });
  server.listen(4200);
  ```

  You can see we are listening on messages. After receiving data we simply inform all other clients, including the socket that sent the message, the data.

  If we restart the app.js file we will see we can now send messages to all other clients when we type anything into our input box and press submit. The div under the hello world message should update.
