---
title: Run Quantum Machine Learning using Pennylane and Scaleway
description: Explore QML capabilities on a range of devices, using the Pennylane framework.
tags: aer aqt iqm quantum qiskit pennylane qaas qml ml
dates:
  validation: 2025-11-27
  posted: 2021-11-21
---

**[Pennylane](https://pennylane.ai/)** is an open-source framework for quantum machine learning (QML), automatic differentiation, and optimization of hybrid quantum-classical computations.
It is among the most popular frameworks for quantum machine learning. It offers a high-level interface for building and training quantum circuits in a hardware-agnostic fashion, using Python.

Scaleway offers access to the `pennylane-scaleway` package, which enables you to run your already written Pennylane's circuits on Scaleway's QaaS infrastructure simply by changing its name.
It is an open-source package under active development and contributions are welcome! Access the repository [here](https://github.com/scaleway/pennylane-scaleway).

## Accessing Pennylane via Scaleway QaaS

### 1. Prerequisites:


Get your `project-id` as well as `secret-key` credentials from your Scaleway account.
You can find them in the **[Scaleway console](https://console.scaleway.com/)**.

Choose one of the following devices to use as a pennylane device:
    * `scaleway.aer`
    * `scaleway.aqt`
    * *Coming Soon:* `scaleway.iqm`

Along the chosen device, you can also decide which backend to use. This will determine the performances of your device. You can find a complete list of the available backend platforms [here](https://www.scaleway.com/en/quantum-as-a-service/#:~:text=Our%20detailed%20QPU%20offers).

For instance you can choose a device-backend pair like:
    * `scaleway.aer` with backend `EMU-AER-2L4` -> a 2 GPUs Aer emulator.
    * `scaleway.aer` with backend `EMU-AER-16C-128M` -> a CPU Aer emulator.
    * `scaleway.aqt` with backend `EMU-IBEX-12PQ-L4` -> single GPU AQT device emulation.

### 2. Installation:

Install the package using pip:
```bash
pip install pennylane-scaleway
```

### 3. Usage:

Then, all you have to do is replace your device definition, with the device-backend pair of your choice and your Scaleway credentials:

```python
import pennylane as qml

device = qml.device("scaleway.aer", wires=2, backend="EMU-AER-2L4", project_id="your-project-id", secret_key="your-secret-key")
...
```

And you're good to go!

<Message type="tip"> You can also define SCW_PROJECT_ID and SCW_SECRET_KEY environment variables. They will automatically be loaded by the plugin. </Message>

## Examples:

```python
import pennylane as qml # You're not dreaming, no need to import pennylane-scaleway as long as it is installed in your current environment.

device = qml.device("scaleway.aer",
        wires=2,
        project_id=<your-project-id>,   # Or set SCW_PROJECT_ID environment variable
        secret_key=<your-secret-key>,   # Or set SCW_SECRET_KEY environment variable
        backend="EMU-AER-16C-128M"
    )

@qml.set_shots(512)
@qml.qnode(device)
def my_circuit():
    qml.Hadamard(wires=0)
    qml.CNOT(wires=[0, 1])
    return qml.counts()

result = my_circuit()
print(result)

device.stop() # Don't forget to close the session when you're done!
```

You can also use the device as a context manager so your session is automatically closed when exiting the context:
```python
import pennylane as qml

with qml.device("scaleway.aqt",
    project_id=<your-project-id>,
    secret_key=<your-secret-key>,
    backend="EMU-IBEX-12PQ-L4",
) as dev:

    @qml.set_shots(512)
    @qml.qnode(dev)
    def circuit():
        qml.Hadamard(wires=0)
        qml.CNOT(wires=[0, 1])
        return qml.counts()

    result = circuit()

print(result)
```

You can explore more demos in our repository, under the [examples](https://github.com/scaleway/pennylane-scaleway/tree/main/doc/examples) directory.

## Session management
A session is automatically created when you instantiate a device. You can manage it manually by calling `device.start()` and `device.stop()`, but it is recommended to use the context manager approach instead.
You may also attach to an existing session, handle maximum session duration and idle duration by setting these as keyword arguments when instantiating the device.
For example:
```python
import pennylane as qml

with qml.device("scaleway.aer",
    wires=2,
    project_id=<your-project-id>,
    secret_key=<your-secret-key>,
    backend="EMU-AER-16C-128M",
    max_duration="1h",
    max_idle_duration="5m"
) as dev:
...
```

You can visualize your sessions on the **[Scaleway Console](https://console.scaleway.com/)** under the Labs/Quantum section.

## Official ressources
* [Scaleway QaaS](https://www.scaleway.com/en/quantum-as-a-service/)
* [Pennylane](https://pennylane.ai/)
