---
meta:
  title: Fetching secrets from the Secret Manager using the Scaleway Github Action
  description: Learn how to use the Scaleway GitHub Action to fetch secrets and expose them as environment variables in your workflow
content:
  h1: Fetching secrets from the Secret Manager using the Scaleway GitHub Action
  paragraph: Learn how to use the Scaleway GitHub Action to fetch secrets and expose them as environment variables in your workflow
tags: secret-management github-action continuous-integration
categories:
  - secret-manager
dates:
  validation: 2023-12-13
  posted: 2023-06-01
---

## GitHub Actions - Overview

[GitHub Actions](https://github.com/features/actions) makes it easy to automate all your software workflows, now with world-class CI/CD. Build, test, and deploy your code right from GitHub. Make code reviews, branch management, and issue triaging work the way you want.

In this tutorial you will learn how to use the [Scaleway Secret Manager GitHub Action](https://github.com/scaleway/action-scw-secret) in your GitHub Actions workflow to retrieve your secrets stored in [Secret Manager](/identity-and-access-management/secret-manager/quickstart/) and expose them as environment variables.

Often times when doing Continuous Integration/Continuous Deployment, you need to access secrets to log in to a Docker registry, push code changes, call APIs, etc.

A good practice is to use a [Secret Manager](/identity-and-access-management/secret-manager/quickstart/) to store your secrets, securely in one place. When doing that, you have to copy and paste your secrets and put them in your CI which duplicates the secrets and leads to descynchronization with your source of truth. This is where GitHub action is useful.

<Macro id="requirements" />

- [Owner](/identity-and-access-management/iam/concepts/#owner) status or [IAM permissions](/identity-and-access-management/iam/concepts/#permission) allowing you to perform actions in the intended Organization
- A valid [API key](/identity-and-access-management/iam/how-to/create-api-keys/)

## Preparing your GitHub repository

You need to create the following secrets in your GitHub repository:

- `SCW_ACCESS_KEY`: your API access key
- `SCW_SECRET_KEY`: your API secret key
- `SCW_DEFAULT_ORGANIZATION_ID`: your organization ID
- `SCW_DEFAULT_PROJECT_ID`: the project ID where you have your secrets

1. Navigate to **Settings** > **Secrets and Variables** > **Actions** of your GitHub repository.
2. Click **New repository secret** and fill in the **Name** and **Secret** fields.
3. Click **Add secret**.
4. Repeat the steps above until you have created all the secrets.

<Message type="note">
 GitHub secrets are immutable. If you want to update the value, you need to delete the current secret and create a new one.
</Message>

<Lightbox src="repository-secrets.webp" alt="repository secrets" />

## Use GitHub Action in your workflow

For the purpose of this tutorial, we suppose you have a workflow defined in `.github/workflows/test.yml`.

1. Add the following code to use the action:

    ```yaml
    [...]
        steps:
    [...]
          - uses: scaleway/action-scw-secret@v0
            with:
              secret-names: |
                my-github-secret
              access-key: ${{ secrets.SCW_ACCESS_KEY }}
              secret-key: ${{ secrets.SCW_SECRET_KEY }}
              default-project-id: ${{ secrets.SCW_DEFAULT_PROJECT_ID }}
              default-organization-id: ${{ secrets.SCW_DEFAULT_ORGANIZATION_ID }}
    [...]
    ```

    This will tell the GitHub action to access the **latest** version of your secret called `my-github-secret` and will expose its value as the environment variable `MY_GITHUB_SECRET`.

2. Use this environment variable in the following steps of the job as follows:

    ```yaml
    [...]
          - run: echo "Successfully retrieve 'my-github-secret' with value $MY_GITHUB_SECRET"
    ```

    The value displays as `***` in the logs of your action to prevent the secret value from being leaked.

## Resources

The full content of the workflow described above is the following:

```yaml
name: Scaleway get secrets action test
on: [push]
jobs:
  test-scaleway-get-secrets:
    runs-on: ubuntu-latest
    steps:
      - uses: scaleway/action-scw-secret@v0
        with:
          secret-names: |
            my-github-secret
          access-key: ${{ secrets.SCW_ACCESS_KEY }}
          secret-key: ${{ secrets.SCW_SECRET_KEY }}
          default-project-id: ${{ secrets.SCW_DEFAULT_PROJECT_ID }}
          default-organization-id: ${{ secrets.SCW_DEFAULT_ORGANIZATION_ID }}
      - run: echo "Successfully retrieve 'my-github-secret' with value $MY_GITHUB_SECRET"
```