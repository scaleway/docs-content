---
meta:
  title: Import data into Serverless SQL Databases
  description: This page explains how to import your data into Serverless SQL Databases from another database or backup files
content:
  h1: Import Data into Serverless SQL Database
  paragraph: This page explains how to import your data into Serverless SQL Databases from another database or backup files
dates:
  validation: 2024-06-24
  posted: 2024-06-24
---

Serverless SQL Databases offers near-complete PostgreSQL compatibility, and allows you to import your data from any PostgreSQL-compatible database.

The import procedure depends on your data source:
    - [Import data from an existing PostgreSQL database](#import-data-from-an-existing-postgresql-database)
    - [Using pg_dump](#using-pgdump)
    - [Using pgAdmin](#using-pgadmin)
    - [Using Airbyte](#using-airbyte)
    - [Using Fivetran](#using-fivetran)
    - [Using Meltano](#using-meltano)
    - [Using Apache NiFi](#using-apache-nifi)
    - [Import Data from a PostgreSQL backup file](#import-data-from-a-postgresql-backup)
    - [Import Data from a file (.csv, .txt, etc.)](#import-data-from-a-file-csv-txt)

## Importing data from an existing PostgreSQL database

### Using pg_dump

#### Before you start

To complete the actions presented below, you must have:

- Installed PostgreSQL 16 (or newer) with [pg_dump](https://www.postgresql.org/docs/current/app-pgdump.html) and [pg_restore](https://www.postgresql.org/docs/current/app-pgrestore.html) (bundled with the default PostgreSQL installation).

- [Created a target Serverless SQL Database](/serverless/sql-databases/how-to/create-a-database) to import your data into.

- Checked that the target database your are importing into is empty, or contains data you can overwrite.

<Message type="note">
This method is suited for database size below ~100 GB. Above this size, you might require to use dedicated tooling to perform the operation as your local storage size and bandwidth will be a botteneck and the operation might last a few hours.
</Message>

#### Downloading and importing data into a Serverless SQL Database

1. Run the following command to download a local export of your database with `pg_dump`, then enter your password when prompted:

    ```
    pg_dump --no-privileges --no-owner -U {username} -h {host} --port {port} -Fc {databasename} > my-backup
    ```

    <Message type="tip">
    You can download specific tables using the `-t` option:

      ```
      pg_dump -t table1name -t table2name --no-privileges --no-owner -U {username} -h {host} --port {port} -Fc {databasename} > my-backup
      ```
    </Message>

2. When finished, make sure the backup was downloaded on your local machine. The default location is in the current directory, under `/my-backup`.

3. Run the command below to import data into your Serverless SQL Database using `pg_restore`. Make sure to replace the placeholders with your Serverless SQL Database connection parameters:

    ```
    pg_restore --no-privileges --no-owner --clean --if-exists -U {username} -h {host} --port 5432 -d {databasename} my-backup
    ```

4. Enter the database password when prompted. 

    <Message type="note">
    The password is the [IAM secret Key](/identity-and-access-management/iam/concepts/#api-key) corresponding to the [IAM user](/identity-and-access-management/iam/concepts/#user) or [IAM application](/identity-and-access-management/iam/concepts/#application) you are connecting with.
    </Message>

5. When finished, make sure your data is stored in your new database by [connecting to it](/serverless/sql-databases/how-to/connect-to-a-database/), and performing a query.

### Using pgAdmin

#### Before you start

To complete the actions presented below, you must:

- Have installed [pg_Admin](https://www.pgadmin.org/).

- Ensure your PGAdmin version is compatible with the PostgreSQL version of the database you will import your data into. Currently, pgAdmin 7.8 or newer is required to fully work with PostgreSQL 16.

- Ensure the target database your are importing into is empty, or contains data you can overwrite.

<Message type="note">
This method is suited for database size below ~100 GB. Above this size, you might require to use dedicated tooling to perform the operation as your local storage size and bandwidth will be a botteneck and the operation might last a few hours.
</Message>

#### Downloading the backup on your local machine

1. Open pgAdmin.

2. Connect to your existing database server by selecting it in the left-hand menu.

3. In the **Databases* submenu, connect to the database you want to export by selecting it.

4. In the left-hand menu, right-click the database you want to export, and select **Backup**.

5. Enter a name for the backup file (e.g. `my-backup`), and keep the default **format** and **compression** options.

6. Click **Backup**. The backup creation process starts, and you can follow its progress by clicking **View processes**.

7. When finished, make sure your backup is downloaded on your local machine. By default, the backup location is `Users/{username}/my-backup` on MacOS.

#### Loading your data in your Serverless SQL Database

1. Register your new database in pgAdmin. Refer to the [How to connect to a Serverless SQL Database](/serverless/sql-databases/how-to/connect-to-a-database/#how-to-set-up-credentials) documentation for more information.

2. Connect to your database server by selecting it in the left-hand menu.

3. Select your database in the **Databases* submenu.

4. In the left-hand menu, right-click the name of your new database, then select **Restore**.

5. Enter filename of your backup (e.g. `my-backup`), and keep the default options.

6. Access the **Data options** tab, and enable the **Do not save - Owner** and **Do not save - Privileges** options.

7. (Optional) If your new database is not empty, access the **Query Options** tab, and enable the **Clean before restore** option. 

    <Message type="tip">
    This option ensures your database is emptied before loading data to avoid potential conflicts with existing data (such as table names or primary key constraints).
    </Message>

8. Click **Restore**. The restore process starts, and you can follow its progress by clicking **View processes**.

9. When finished, make sure your data is stored in your new database by [connecting to it](/serverless/sql-databases/how-to/connect-to-a-database/), and performing a query.

If the process fails and some data were partly already transfered, we suggest you activate the **Clean before restore** option in the **Data options** tab to remove partly transfered data.

### Using Airbyte

#### Before you start

To complete the actions presented below, you must:

- Have access to [Airbyte Cloud](https://cloud.airbyte.com/) or have [Airbyte installed](https://docs.airbyte.com/deploying-airbyte/quickstart) on your machine.

<Message type="note">
To avoid any statement timeout errors with Managed Database for PostgreSQL (e.g. `ERROR: canceling statement due to statement timeout`), we recommend you setup the PostgreSQL parameter `statement_timeout` to `1200000` (20 minutes), as recommended by Airbyte for other PostgreSQL-compatible data sources. You can modify this parameter in your [database overview in the Scaleway console](https://console.scaleway.com/rdb/instances), by clicking **More**, then **Advanced Settings**.
</Message>

#### Adding your existing database as source

1. From the Airbyte user interface, click **Sources**.

2. Select **Postgres** from the list of sources.

3. Fill in the required information to connect to your existing database:
  - **Host**
  - **Port**
  - **Database Name**
  - *Username**
  - **Password**

4. Select an SSL Mode and a SSH Tunnel Method.

5. Select **Detect Changes with Xmin System Column** as **Update Method** (other methods are not supported).

4. Click **Set up source**.

#### Adding your new Serverless SQL Database as destination

1. Click **Create a connection**.

2. Select **Postgres** from the list of destinations.

3. Fill in the required information to connect to your existing database:
  - **Host**
  - **Port**
  - **Database Name**
  - *Username**
  - **Password**

4. Select an SSL Mode and a SSH Tunnel Method.

5. Click **Set up destination**.

5. Select the streams (tables) you want to load in your new Serverless SQL Database, then click **Next**.

6. Edit the remaining options if required, then click **Finish & Sync**.

7. When finished, make sure your data is stored in your new database by connecting to it, and performing a query.

<Message type="important">
This procedure does not currently work with Serverless SQL Database. However, you can import your backup using [Managed Database for PostgreSQL and MySQL](/managed-databases/postgresql-and-mysql/).
</Message>

### Using Fivetran

#### Before you start

To complete the actions presented below, you must:

- have a Fivetran account and can connect to the [Fivetran console](https://fivetran.com/dashboard)

#### Connecting Fivetran to your Serverless SQL Database

1. From the Fivetran user interface, click **Add destination** in the [destinations list](https://fivetran.com/dashboard/destinations).

2. Enter a name for the destination (e.g. `my-new-database`), then click **Add**.

3. Select **PostgreSQL**, then click **Select**.

4. Fill in the required information to connect to your existing database:

    - **Host**
    - **Port**
    - **Database Name**
    - *Username**
    - **Password**

    <Message type="note">
    You can find these information in the [overview page](https://console.scaleway.com/serverless-db/databases) of your database. The password is the [IAM Secret Key](/identity-and-access-management/iam/concepts/#api-key) corresponding to the [IAM user](/identity-and-access-management/iam/concepts/#user) or [IAM application](/identity-and-access-management/iam/concepts/#application) you are connecting with. 
    </Message>

5. Select **Connect directly** as **Connection method**.

6. Select **Detect Changes via XMIN** as **Update Method** (other methods are not supported).

    <Message type="note">
    If you have set up IP adress access restrictions from your IAM policies, copy the adresses from Fivetran IPs and edit your IAM policies to whitelist them.
    </Message>

7. Click **Save & Continue**.

8. Select the certificate in the list corresponding to `CN=sdb.{region}.scw.cloud`, check its validity, and confirm your selection by clicking **Confirm**. 

    <Message type="tip">
    You can ensure the certificate is fully valid only if all of following checks are true:
      - Origin is Let's Encrypt
      - CN field is `sdb.{region}.scw.cloud`
      - complete certificate value is the same as the one hosted on `sdb.{region}.scw.cloud`
      - root certificate is the same as [Let's Encrypt ISRG X1 Root certificate](https://letsencrypt.org/certs/isrgrootx1.pem)
    </Message>

#### Connecting Fivetran to your existing database

1. From the Fivetran user interface, click **Add connector** in the [connectors list](https://fivetran.com/dashboard/connectors).``

2. Select your destination (for instance `my-new-database`), then click **Select**.

3. Select **PostgreSQL**, then click **Set up**.

4. Fill in the required information to connect to your existing database:

    - **Host**
    - **Port**
    - **Database Name**
    - *Username**
    - **Password**

    <Message type="note">
    You can find these information in the [overview page](https://console.scaleway.com/serverless-db/databases) of your database. The password is the [IAM Secret Key](/identity-and-access-management/iam/concepts/#api-key) corresponding to the [IAM user](/identity-and-access-management/iam/concepts/#user) or [IAM application](/identity-and-access-management/iam/concepts/#application) you are connecting with. 
    </Message>

5. Select **Connect directly** as **Connection method**.

6. Select **Detect Changes via XMIN** as **Update Method** (other methods are not supported).

    <Message type="note">
    If you have set up IP adress access restrictions from your IAM policies, copy the adresses from Fivetran IPs and edit your IAM policies to whitelist them.
    </Message>

7. Click **Save & Continue**.

6. When the database schemas and tables display, select the one you want to import, then click **Save & Continue**.

7. Select your prefered way of synchronizing future schemas changes and then click **Save & Continue**.

8. Click **Start Initial Sync**.

9. When finished, make sure your data is stored in your new database by connecting to it, and performing a query.

<Message type="important">
This procedure does not currently work with Serverless SQL Database. However, you can import your backup using [Managed Database for PostgreSQL and MySQL](/managed-databases/postgresql-and-mysql/).
</Message>

### Using Meltano

Tools such as [Meltano](https://meltano.com/) are better suited to load data only, without keeping constraints on columns types or relations. To load all PostgreSQL objects (such as table constraints, users, etc.), we recomment using other tools such as [`pg_dump` and `pg_restore`](#using-pgdump).

#### Before you start

To complete the actions presented below, you must:
 
- Have installed [Meltano](https://docs.meltano.com/getting-started/installation/)

#### Initializing your Meltano project

1. In a terminal, run the command below to initialize a Meltano project named `migrate-postgresql`:

    ```sh
    meltano init migrate-postgresql
    ```

2. Run the following command to access the newly created directory that contains the project:

    ```sh
    cd migrate-postgresql
    ```

3. Run the following command to add a PostgreSQL-compatible extractor and loader:

    ```sh
    meltano add extractor tap-postgres
    meltano add loader target-postgres
    ```

#### Configure extractor to connect to your existing database

1. Fill in the information required to connect to your existing database:

    ```sh
    meltano config tap-postgres set --interactive
    ```

    A list of settings displays, with a number associated to each parameter.

2. Enter the required information below by entering the numer associated to each parameter:

    - **Database Name** (5)
    - **Host** (13)
    - **Password** (14)
    - **Port** (15)
    - *Username** (32)

3. Select the tables you want to load:

    ```
    meltano select tap-postgres {schema-name}-{table1name}
    meltano select tap-postgres {schema-name}-{table2name}
    ...
    ```

    <Message type="tip">
    for instance `meltano select tap-postgres public-cities` if you are importing the table `cities` from the schema `public`.
    You can check the selected tables and columns with `meltano select tap-postgres --list --all`.
    </Message>

#### Configure loader to connect to your new Serverless SQL Database
1. Fill in the information required to connect to your new Serverless SQL Database:
   ```sh
   meltano config target-postgres set --interactive
   ```
   `database`, `host`, `password`, `port` and `user` fields are mandatory

#### Execute data import and loading
1. Execute data import and loading with:
   ```sh
   meltano run tap-postgres target-postgres
   ```
2. When the process is finished, you can check your data is now stored in your new database by connecting to it and performing a query. By default, with the `tap-postgres` extractor, data will be loaded in the `tap_postgres` schema and not the `public` schema. Hence you can find your loaded tables with a command such as `SELECT * from tap-postgres.{table1name} LIMIT 10;`.


**(To be finished to test and document)**
### Using Apache NiFi

Requirements:
- You have installed or have access to [Apache Nifi](https://nifi.apache.org/)

#### Configure Processor to connect to your existing database
1. Drag and drop a **Processor** onto the main interface.
2. Right click and select **Configure**.
3. Go to **Properties** tab.
4. Fill in the required information:
  - Database Type: Select **PostgreSQL**
  - Table Name: The name of the table you want to load content from
  - Database Connection Pooling Service: Click **Create new service**, select **DBCPConnectionPool**, click **OK** and click the arrow to the right to access DBCPConnectionPool configuration
5. Click **Configure** icon for DBCPConnectionPool and fill in the required information:
  - Database Connection URL: Connection string for your database in the form `jdbc:postgresql://{host}:{port}/{databasename}`
  - Database Driver Class Name: org.postgresql.Driver
  - Database Driver Location(s): full path to your postgresql compatible driver
  - Database User and Password: Credentials to login to your database
  You can check your connection works by clicking on the checkbox icon, and then on **Verify**
6. Enable your DBCPConnectionPool by clicking on the thunder icon and then **Enable**


## Import Data from an existing PostgreSQL backup

### Using pg_restore

Requirements:
- [pg_restore](https://www.postgresql.org/docs/current/app-pgrestore.html) tool is installed on your local machine (it is bundled with default PostgreSQL installation), with a version compatible with the PostgreSQL version you will import your database to. Currently, pg_restore version above 16 is required to work fully with PostgreSQL 16.
- Make sure the database your are importing to is empty, for instance by creating a new Serverless SQL Database.
- This method is suited for database size below ~100 GB. Above this size, you might require to use dedicated tooling to perform the operation as your local storage size and bandwidth will be a botteneck and the operation might last a few hours.

1. Assuming you have a file named `my-backup` in your current directory, use pg_restore to import data to your Serverless SQL Database:
   ```sh
    pg_restore --no-privileges --no-owner --clean --if-exists -U {username} -h {host} --port 5432 -d {databasename} my-backup
   ```
   where `username`, `host` and `databasename` are your Serverless SQL Database connection parameters. You can find them in the [Scaleway Console Overview page](https://console.scaleway.com/serverless-db/databases) for your database.
   Provide your database password when prompted for it. The password is the [IAM Secret Key](https://www.scaleway.com/en/docs/identity-and-access-management/iam/concepts/#api-key) corresponding to the [IAM user](https://www.scaleway.com/en/docs/identity-and-access-management/iam/concepts/#user) or [IAM application](https://www.scaleway.com/en/docs/identity-and-access-management/iam/concepts/#application) you are connecting with. 
2. When the process is finished, you can check your data is now stored in your new database by connecting to it and performing a query.

## Import Data from a file (.csv, .txt...)

### Using psql

Requirements:
- [psql](https://www.postgresql.org/docs/current/app-psql.html) tool is installed on your local machine (it is bundled with default PostgreSQL installation), with a version compatible with the PostgreSQL version you will import your database to. Currently, psql version above 16 is required to work fully with PostgreSQL 16.
- You have a data file corresponding to a single table in your current directory. For instance a csv file named `my-table.csv`.
- Make sure the database your are importing to is empty, or that you accept to overwrite existing data stored inside your database
- This method is suited for file size below ~100 GB. Above this size, you might require to use dedicated tooling to perform the operation as your local storage size and bandwidth will be a botteneck and the operation might last a few hours.

<Message type="tip">
  You can create a csv file from an existing PostgreSQL table using the same process as below, using `\copy ... TO ...` instead of `\copy ... FROM ...` after connecting to the database using `psql`. In this example, the full command would be `\copy {tablename} TO './my-table.csv' WITH DELIMITER ',' CSV;`.
</Message>

1. Connect to your Serverless SQL Database using psql:
    ```sh
    psql "postgresql://{username}:{password}@{host}:5432/{databasename}?sslmode=require"
    ```
    where `username`, `host` and `databasename` are your Serverless SQL Database connection parameters. You can find them in the [Scaleway Console Overview page](https://console.scaleway.com/serverless-db/databases) for your database.
    and `password` is the [IAM Secret Key](https://www.scaleway.com/en/docs/identity-and-access-management/iam/concepts/#api-key) corresponding to the [IAM user](https://www.scaleway.com/en/docs/identity-and-access-management/iam/concepts/#user) or [IAM application](https://www.scaleway.com/en/docs/identity-and-access-management/iam/concepts/#application) you are connecting with. 
2. Create the table structure corresponding to your file columns types:
   ```sql
   CREATE TABLE {tablename} (column1name type1, column2name type2, ...);
   ```
3. Assuming you have a .csv file located on your current directory `./my-table.csv`, load its data to your Serverless SQL Database using [psql \copy command](https://www.postgresql.org/docs/current/app-psql.html#APP-PSQL-META-COMMANDS-COPY):
    ```sh
    \copy {tablename} FROM './my-table.csv' WITH DELIMITER ',' CSV;
    ```

<Message type="tip">
  The PostgreSQL [command `COPY`](https://www.postgresql.org/docs/current/sql-copy.html) cannot be used directly since it requires the source file to be available on the PostgreSQL instance itself. 
</Message>
